I got somewhere. I defined an input language, which is ok, and bult a parser, which makes an AST tree from generic nodes. Try,

./dancerc.py -p ast ../test/test

Where to go from here is difficult.


=== in SHORT
Don't know where control goes after scm/lilly. Does it run the functions in scm/music-functions?

Don't know what a music event is as data, besides a type.

Don't know how engravers get attached to contexts

Don't know if final coordinates are controlled by engravers or layout. Or where they are triggerd.

Can't find layout data either

Or how bars are handled---objects or calculated?

Or how columns align across lists


Or final X/Y coordinate holders.

All bad.

See also,
http://lilypond.org/doc/v2.18/Documentation/contributor/overview-of-lilypond-architecture
?
This is good, on the music sreaam, though it fails to explain interlacing?

http://lilypond.org/website/pdf/thesis-erik-sandberg.pdf
?


== What we need
We do need a basic parse, if only for error checking.
...and expansion
We need this general AST to render to a neutral struction to be used for both text and animation rendering.

Would this be a music stream, with notes marked?
e.g.
(time 0: note eâ€™2, lower staff, lower voice)
for dancer
(time 0: move clap dancer 1)

So we need to add time and dancer id, while interlacing.
We need specific renderers for text and animation.

Like Lilypond, we could maybe use having these two different results fro a flexible phase structure, like lillypond's engraver/performance split.
 
== PDF rendering
TODO: Main one---decide how to generate x/y coordinates fron the tree parse.
And also, how to coordinate between dancers?

scm/music-functions has tree recursers? These pesumably do...
TODO: compiler phases to generate specifics from the generic parse. In particular, instruction functions must be run to generate event, e.g. non visual repeats expanded, visual repeats with barline instructions, etc.
 
== Output control 
We would like a separate output control, possibly to PDF, to PNG, to print, etc. We may even want caching of processing?

page processing?

